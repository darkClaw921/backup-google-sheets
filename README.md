# Backup Google Sheets

Приложение для автоматического создания резервных копий таблиц Google Sheets.

## Функции

- Подключение к Google Sheets через сервисный аккаунт
- Настройка расписания бэкапов
- Модульная система хранения бэкапов (различные провайдеры)
- Веб-интерфейс для управления бэкапами

## Установка

```bash
# Клонирование репозитория
git clone https://github.com/yourusername/backup-google-sheets.git
cd backup-google-sheets

# Установка зависимостей с использованием uv
uv sync

# Настройка переменных окружения
cp .env.example .env
# Отредактируйте .env файл, добавив свои учетные данные

# Запуск приложения
uv run uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### Docker

```bash
docker-compose build
docker-compose up -d
```




## Требования

- Python 3.12+
- Сервисный аккаунт Google с доступом к API Google Sheets и Google Drive

## Настройка сервисного аккаунта

1. Создайте сервисный аккаунт в Google Cloud Console
2. Создайте и скачайте ключ в формате JSON
3. Разместите ключ в директории `credentials/` и обновите путь в `.env` файле
4. Предоставьте доступ сервисному аккаунту к целевым таблицам 

## Инструкция для пользователя

### Добавление новой таблицы Google Sheets

1. **Предоставление доступа сервисному аккаунту**:
   - Откройте вашу таблицу Google Sheets
   - Нажмите на кнопку "Поделиться" в правом верхнем углу
   - В поле "Добавить пользователей и группы" введите email сервисного аккаунта: `service-account@still-sight-454310-a6.iam.gserviceaccount.com`
   - Установите права доступа "Редактор" или "Просмотр" (минимум "Просмотр" для создания бэкапов)
   - Нажмите "Готово"

2. **Получение ID таблицы**:
   - ID таблицы находится в URL между `/d/` и `/edit`
   - Например, для URL `https://docs.google.com/spreadsheets/d/1a2b3c4d5e6f7g8h9i0j/edit#gid=0`, ID будет `1a2b3c4d5e6f7g8h9i0j`

3. **Добавление таблицы в систему**:
   - Откройте веб-интерфейс приложения и перейдите на страницу "Таблицы"
   - Нажмите кнопку "Добавить таблицу"
   - Введите название таблицы (произвольное, для удобства идентификации)
   - Вставьте ID таблицы, полученный на предыдущем шаге
   - Нажмите "Сохранить"

### Создание расписания бэкапов

1. **Перейдите на страницу "Расписания"**:
   - В главном меню выберите раздел "Расписания"
   - Нажмите кнопку "Добавить расписание"

2. **Настройка параметров расписания**:
   - **Выбор таблиц**: Выберите одну или несколько таблиц из выпадающего списка (для выбора нескольких таблиц удерживайте Ctrl/Cmd)
   - **Тип расписания**: Выберите тип расписания:
     - **Интервальное**: Бэкапы создаются через равные промежутки времени
     - **Cron**: Бэкапы создаются по указанному cron-выражению (например, каждый день в определенное время)

3. **Настройка хранилища бэкапов**:
   - Выберите одно или несколько хранилищ для сохранения бэкапов:
     - **Локальное**: Бэкапы сохраняются на сервере приложения
     - **Bitrix24**: Бэкапы сохраняются в Битрикс24 (требуется настройка интеграции)
     - **Другие**: В зависимости от установленных провайдеров

4. **Активация расписания**:
   - Убедитесь, что опция "Активно" включена, если хотите, чтобы расписание начало работать сразу
   - Нажмите "Сохранить"

### Ручное создание бэкапа

1. На странице "Таблицы" найдите нужную таблицу и нажмите кнопку "Создать бэкап"
2. Выберите хранилища и нажмите "Создать"
3. Или на странице "Расписания" найдите нужное расписание и нажмите кнопку "Запустить сейчас"

### Просмотр и управление бэкапами

1. Перейдите на страницу "Бэкапы"
2. Здесь вы увидите список всех созданных бэкапов с информацией о размере, дате создания и хранилище
3. Вы можете скачать или удалить любой бэкап 